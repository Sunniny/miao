import{f as I,d as P,k as V,aC as ne,V as oe,U as F,b as o,T as O,g as p,I as k,n as J,aD as ae,ar as le,t as se,p as ie,l as K,a4 as ce,L as re,ab as Y,ac as ue,$ as de,aE as fe,aF as j,aG as me,aH as ge,aI as Be,D as he,aJ as be,az as ve,aq as q,u as ye,r as R,c as $,a as h,w as E,an as M,ao as Ce,ak as N,o as z,e as D,ap as _e,a5 as we}from"./index-11d64c67.js";import{m as xe,u as ke}from"./mount-component-d6395caf.js";import{L as pe,a as Se,p as Pe,b as Te,P as De,c as Ie}from"./index-15213e54.js";import{a as Q,u as X}from"./use-route-27cce48f.js";const[Z,W]=I("action-bar"),ee=Symbol(Z),Oe={placeholder:Boolean,safeAreaInsetBottom:F};var Ae=P({name:Z,props:Oe,setup(e,{slots:l}){const t=V(),i=ne(t,W),{linkChildren:s}=oe(ee);s();const r=()=>{var m;return o("div",{ref:t,class:[W(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[(m=l.default)==null?void 0:m.call(l)])};return()=>e.placeholder?i(r):r()}});const Le=O(Ae),[Re,x]=I("button"),$e=p({},Q,{tag:k("button"),text:String,icon:String,type:k("default"),size:k("normal"),color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:k("button"),loadingSize:J,loadingText:String,loadingType:String,iconPosition:k("left")});var Ee=P({name:Re,props:$e,emits:["click"],setup(e,{emit:l,slots:t}){const i=X(),s=()=>t.loading?t.loading():o(pe,{size:e.loadingSize,type:e.loadingType,class:x("loading")},null),r=()=>{if(e.loading)return s();if(t.icon)return o("div",{class:x("icon")},[t.icon()]);if(e.icon)return o(le,{name:e.icon,class:x("icon"),classPrefix:e.iconPrefix},null)},m=()=>{let a;if(e.loading?a=e.loadingText:a=t.default?t.default():e.text,a)return o("span",{class:x("text")},[a])},u=()=>{const{color:a,plain:b}=e;if(a){const f={color:b?a:"white"};return b||(f.background=a),a.includes("gradient")?f.border=0:f.borderColor=a,f}},d=a=>{e.loading?se(a):e.disabled||(l("click",a),i())};return()=>{const{tag:a,type:b,size:f,block:y,round:C,plain:_,square:S,loading:A,disabled:n,hairline:c,nativeType:v,iconPosition:g}=e,w=[x([b,f,{plain:_,block:y,round:C,square:S,loading:A,disabled:n,hairline:c}]),{[ae]:c}];return o(a,{type:v,class:w,style:u(),disabled:n,onClick:d},{default:()=>[o("div",{class:x("content")},[g==="left"&&r(),m(),g==="right"&&r()])]})}}});const H=O(Ee),[Ne,ze]=I("action-bar-button"),Fe=p({},Q,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var He=P({name:Ne,props:Fe,setup(e,{slots:l}){const t=X(),{parent:i,index:s}=ie(ee),r=K(()=>{if(i){const u=i.children[s.value-1];return!(u&&"isButton"in u)}}),m=K(()=>{if(i){const u=i.children[s.value+1];return!(u&&"isButton"in u)}});return Se({isButton:!0}),()=>{const{type:u,icon:d,text:a,color:b,loading:f,disabled:y}=e;return o(H,{class:ze([u,{last:m.value,first:r.value}]),size:"large",type:u,icon:d,color:b,loading:f,disabled:y,onClick:t},{default:()=>[l.default?l.default():a]})}}});const G=O(He),[Ue,B,T]=I("dialog"),Ve=p({},Pe,{title:String,theme:String,width:J,message:[String,Function],callback:Function,allowHtml:Boolean,className:ce,transition:k("van-dialog-bounce"),messageAlign:String,closeOnPopstate:F,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:F,closeOnClickOverlay:Boolean}),Ke=[...Te,"transition","closeOnPopstate"];var te=P({name:Ue,props:Ve,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:l,slots:t}){const i=V(),s=re({confirm:!1,cancel:!1}),r=n=>l("update:show",n),m=n=>{var c;r(!1),(c=e.callback)==null||c.call(e,n)},u=n=>()=>{e.show&&(l(n),e.beforeClose?(s[n]=!0,Ie(e.beforeClose,{args:[n],done(){m(n),s[n]=!1},canceled(){s[n]=!1}})):m(n))},d=u("cancel"),a=u("confirm"),b=fe(n=>{var c,v;if(n.target!==((v=(c=i.value)==null?void 0:c.popupRef)==null?void 0:v.value))return;({Enter:e.showConfirmButton?a:j,Escape:e.showCancelButton?d:j})[n.key](),l("keydown",n)},["enter","esc"]),f=()=>{const n=t.title?t.title():e.title;if(n)return o("div",{class:B("header",{isolated:!e.message&&!t.default})},[n])},y=n=>{const{message:c,allowHtml:v,messageAlign:g}=e,w=B("message",{"has-title":n,[g]:g}),L=me(c)?c():c;return v&&typeof L=="string"?o("div",{class:w,innerHTML:L},null):o("div",{class:w},[L])},C=()=>{if(t.default)return o("div",{class:B("content")},[t.default()]);const{title:n,message:c,allowHtml:v}=e;if(c){const g=!!(n||t.title);return o("div",{key:v?1:0,class:B("content",{isolated:!g})},[y(g)])}},_=()=>o("div",{class:[Be,B("footer")]},[e.showCancelButton&&o(H,{size:"large",text:e.cancelButtonText||T("cancel"),class:B("cancel"),style:{color:e.cancelButtonColor},loading:s.cancel,disabled:e.cancelButtonDisabled,onClick:d},null),e.showConfirmButton&&o(H,{size:"large",text:e.confirmButtonText||T("confirm"),class:[B("confirm"),{[ge]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:s.confirm,disabled:e.confirmButtonDisabled,onClick:a},null)]),S=()=>o(Le,{class:B("footer")},{default:()=>[e.showCancelButton&&o(G,{type:"warning",text:e.cancelButtonText||T("cancel"),class:B("cancel"),color:e.cancelButtonColor,loading:s.cancel,disabled:e.cancelButtonDisabled,onClick:d},null),e.showConfirmButton&&o(G,{type:"danger",text:e.confirmButtonText||T("confirm"),class:B("confirm"),color:e.confirmButtonColor,loading:s.confirm,disabled:e.confirmButtonDisabled,onClick:a},null)]}),A=()=>t.footer?t.footer():e.theme==="round-button"?S():_();return()=>{const{width:n,title:c,theme:v,message:g,className:w}=e;return o(De,Y({ref:i,role:"dialog",class:[B([v]),w],style:{width:de(n)},tabindex:0,"aria-labelledby":c||g,onKeydown:b,"onUpdate:show":r},ue(e,Ke)),{default:()=>[f(),C(),A()]})}}});let U;const je={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let qe=p({},je);function Me(){({instance:U}=xe({setup(){const{state:l,toggle:t}=ke();return()=>o(te,Y(l,{"onUpdate:show":t}),null)}}))}function We(e){return he?new Promise((l,t)=>{U||Me(),U.open(p({},qe,e,{callback:i=>{(i==="confirm"?l:t)(i)}}))}):Promise.resolve()}const Ge=e=>We(p({showCancelButton:!0},e));O(te);const Je={class:"p-4 text-xl"},Ye={class:"divide-y mb-16"},Qe=["onClick"],Xe=h("span",null,"30",-1),Ze=h("span",null,"📚",-1),et=h("span",{class:"h-16 basis-0 grow flex flex-col justify-center items-center"},[h("span",null,"📚"),D("分享")],-1),tt=["onClick"],nt=h("span",null,"📚",-1),it=P({__name:"MyVotes",async setup(e){let l,t;var[i,s]=be(),r=V([]);try{var m=([l,t]=ve(()=>q.get("/vote")),l=await l,t(),l);r.value=m.data.result}catch{r.value=[],ye()}async function u(d,a){try{await Ge({message:`确认删除 [${d.title}] 吗？`}),await q.delete("/vote/"+d.voteId),r.value.splice(a,1),s(-1)}catch{}}return(d,a)=>{const b=R("ArrowLeftBold"),f=R("el-icon"),y=R("RouterLink");return z(),$(M,null,[h("h1",Je,[o(y,{to:"/me",class:"inline-flex gap-2 items-center"},{default:E(()=>[o(f,{class:"relative"},{default:E(()=>[o(b)]),_:1}),D(" 我的投票 ")]),_:1})]),h("div",Ye,[(z(!0),$(M,null,Ce(N(r),(C,_)=>(z(),$("div",{key:C.voteId},[h("div",{class:"hover:bg-green-100 flex px-4 items-center justify-between h-16",onClick:S=>N(s)(_)},[h("span",null,_e(C.title),1),Xe],8,Qe),h("div",{class:we([{hidden:N(i)!==_},"flex items-center border-t"])},[o(y,{to:`/vote/${C.voteId}`,class:"h-16 basis-0 grow flex flex-col justify-center items-center"},{default:E(()=>[Ze,D("查看")]),_:2},1032,["to"]),et,h("span",{onClick:S=>u(C,_),class:"h-16 basis-0 grow flex flex-col justify-center items-center"},[nt,D("删除")],8,tt)],2)]))),128))])],64)}}});export{it as default};
